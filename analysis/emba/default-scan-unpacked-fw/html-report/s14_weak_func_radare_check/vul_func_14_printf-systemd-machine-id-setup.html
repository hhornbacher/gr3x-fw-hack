<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2023 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s): Pascal Eckmann
Contributor(s): Michael Messner, Stefan Haboeck
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s14_weak_func_radare_check.html" title="./../s14_weak_func_radare_check.html" >&laquo; Back to s14_weak_func_radare_check</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<a class="reference" href="./vul_func_14_printf-systemd-machine-id-setup/s12_binary_protection.html" title="./vul_func_14_printf-systemd-machine-id-setup/s12_binary_protection.html" ><pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">systemd-machine-id-setup</span></pre></a>

<br />
<pre>  </pre>
<pre>  	<span class="green">Full RELRO</span>     <span class="green">Canary found</span>      <span class="green">NX enabled</span>   <span class="green">PIE enabled</span>  <span class="green">No RPATH</span>     <span class="green">No RUNPATH</span>   <span class="green">No Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> tear down of </span><span class="orange">systemd-machine-id-setup</span></pre>
<br />
<pre>str r2, [sp, 0x24]</pre>
<pre>str sl, [sp, 0x20]</pre>
<pre>ldr r2, [sp, 0x70]</pre>
<pre>str r2, [sp, 0x1c]</pre>
<pre>str r3, [sp, 0x18]</pre>
<pre>str lr, [sp, 0x14]</pre>
<pre>str r4, [sp, 0x10]</pre>
<pre>ldr r3, [sp, 0x64]</pre>
<pre>str r3, [sp, 0xc]</pre>
<pre>str fp, [sp, 8]</pre>
<pre>ldr r3, [sp, 0x60]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>ldr r3, [0x00004ef8]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x800</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>add r4, sp, 0xb4</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>str r4, [sp, 0x94]</pre>
<pre>mov r0, r4</pre>
<pre>--</pre>
<pre>str r7, [r6, 0x18]</pre>
<pre>str r5, [sp, 0x54]</pre>
<pre>mov r3, 5</pre>
<pre>str r3, [sp, 0x58]</pre>
<pre>ldr r3, [0x00005924]</pre>
<pre>add r3, pc, r3</pre>
<pre>ldr r3, [r3]</pre>
<pre>cmp r3, r7</pre>
<pre>blt 0x5624</pre>
<pre>add r3, sp, 0x68</pre>
<pre>mov r0, r3</pre>
<pre>str r3, [sp, 0x3c]</pre>
<pre>ldr r3, [sp, 0x14]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>ldr r3, [0x00005928]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0xf</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0xe</pre>
<pre>bhi 0x57e8</pre>
<pre>--</pre>
<pre>subs r3, r0, 0</pre>
<pre>beq 0x57a0</pre>
<pre>add r7, sp, 0xbc</pre>
<pre>ldr r2, [0x0000592c]</pre>
<pre>add r2, pc, r2</pre>
<pre>mov r1, 0x40</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.imp.strftime</pre>
<pre>cmp r0, 0</pre>
<pre>beq 0x57a0</pre>
<pre>bl sym.imp.getpid</pre>
<pre>add r8, sp, 0x78</pre>
<pre>str r0, [sp, 4]</pre>
<pre>ldr r3, [0x00005930]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x11</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r8</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x10</pre>
<pre>bhi 0x5848</pre>
<pre>--</pre>
<pre>add r7, sp, 0xbc</pre>
<pre>mov r2, 0x28</pre>
<pre>mov r1, 0</pre>
<pre>mov r0, r7</pre>
<pre>bl sym.imp.memset</pre>
<pre>ldr r6, [0x00005940]</pre>
<pre>add r6, pc, r6</pre>
<pre>ldr r3, [r6]</pre>
<pre>cmp r3, 0</pre>
<pre>blt 0x505c</pre>
<pre>add r8, sp, 0x78</pre>
<pre>ldr r3, [sp, 0x14]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>ldr r3, [0x00005944]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0xf</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r8</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0xe</pre>
<pre>bhi 0x57c8</pre>
<pre>bl sym.imp.getpid</pre>
<pre>add r5, sp, 0x8c</pre>
<pre>str r0, [sp, 4]</pre>
<pre>ldr r3, [0x00005948]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x11</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r5</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x10</pre>
<pre>bhi 0x5828</pre>
<pre>--</pre>
<pre>bl sym.imp.writev</pre>
<pre>b 0x5118</pre>
<pre>movw r1, 0x4240</pre>
<pre>movt r1, 0xf</pre>
<pre>movw r2, 0x4240</pre>
<pre>movt r2, 0xf</pre>
<pre>mov r3, 0</pre>
<pre>smlal r8, sb, r1, r7</pre>
<pre>mov r0, r8</pre>
<pre>mov r1, sb</pre>
<pre>bl sym.imp.__aeabi_uldivmod</pre>
<pre>b 0x52c0</pre>
<pre>ldr r3, [sp, 0x14]</pre>
<pre>str r3, [sp]</pre>
<pre>ldr r3, [0x00005964]</pre>
<pre>add r3, pc, r3</pre>
<pre>mov r2, 0xf</pre>
<pre>mov r1, r6</pre>
<pre>add r7, sp, 0x78</pre>
<pre>mov r0, r7</pre>
<pre><span class="red">bl sym.imp.__sprintf_chk</span></pre>
<pre>str r7, [sp, 0x8c]</pre>
<pre>mov r0, r7</pre>
<pre>--</pre>
<pre>beq 0x5060</pre>
<pre>cmp sl, 0</pre>
<pre>bne 0x4fd4</pre>
<pre>b 0x5120</pre>
<pre>str sb, [sp, 0x10]</pre>
<pre>cmp sl, 0</pre>
<pre>bne 0x4fd4</pre>
<pre>b 0x5120</pre>
<pre>add r7, sp, 0xbc</pre>
<pre>ldr r3, [sp, 0x20]</pre>
<pre>str r3, [sp, 8]</pre>
<pre>ldr r3, [sp, 0x1c]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>ldr r3, [0x00005968]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x40</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r7</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x3f</pre>
<pre>bhi 0x5868</pre>
<pre>--</pre>
<pre>add r3, pc, r3</pre>
<pre>movw r2, 0x161</pre>
<pre>ldr r1, [0x000059c0]</pre>
<pre>add r1, pc, r1</pre>
<pre>ldr r0, [0x000059c4]</pre>
<pre>add r0, pc, r0</pre>
<pre>bl 0x62ac</pre>
<pre>bl sym.imp.__stack_chk_fail</pre>
<pre>add r7, sp, 0xbc</pre>
<pre>ldr r3, [sp, 0x20]</pre>
<pre>str r3, [sp, 8]</pre>
<pre>ldr r3, [sp, 0x1c]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>ldr r3, [0x000059c8]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x40</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r7</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x3f</pre>
<pre>bhi 0x5868</pre>
<pre>--</pre>
<pre>ldr r3, [0x00005e44]</pre>
<pre>add r3, pc, r3</pre>
<pre>ldr r2, [0x00005e48]</pre>
<pre>ldr r3, [r3, r2]</pre>
<pre>str r3, [fp, -0x838]</pre>
<pre>ldr r3, [r3]</pre>
<pre>str r3, [fp, -0x28]</pre>
<pre>subs sb, r0, 0</pre>
<pre>beq 0x5df8</pre>
<pre>ldr r3, [fp, -0x834]</pre>
<pre>cmp r3, 0</pre>
<pre>beq 0x5e18</pre>
<pre>sub sp, sp, 0x28</pre>
<pre>add r4, sp, 8</pre>
<pre>mov r1, 1</pre>
<pre>str r1, [sp]</pre>
<pre>ldr r3, [0x00005e4c]</pre>
<pre>add r3, pc, r3</pre>
<pre>mov r2, 0x1b</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.__sprintf_chk</span></pre>
<pre>ldr r1, [0x00005e50]</pre>
<pre>add r1, pc, r1</pre>
<pre>--</pre>
<pre>bne 0x6178</pre>
<pre>add sp, sp, 0x810</pre>
<pre>add sp, sp, 0xc</pre>
<pre>pop {r4, r5, r6, r7, r8, sb, sl, fp, pc}</pre>
<pre>rsb r4, r4, 0</pre>
<pre>and r3, r6, 7</pre>
<pre>ldr r2, [0x00006188]</pre>
<pre>add r2, pc, r2</pre>
<pre>ldr r2, [r2]</pre>
<pre>cmp r3, r2</pre>
<pre>bgt 0x60e4</pre>
<pre>str r4, [r5]</pre>
<pre>ldr r3, [sp, 0x848]</pre>
<pre>str r3, [sp, 4]</pre>
<pre>str fp, [sp]</pre>
<pre>mov r3, 0x800</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>add fp, sp, 0x14</pre>
<pre>mov r0, fp</pre>
<pre><span class="red">bl sym.imp.__vsnprintf_chk</span></pre>
<pre>stm sp, {sl, fp}</pre>
<pre>mov r3, sb</pre>
<pre>--</pre>
<pre>ldr ip, [0x00006240]</pre>
<pre>add ip, pc, ip</pre>
<pre>ldr ip, [ip]</pre>
<pre>cmp lr, ip</pre>
<pre>ble 0x61bc</pre>
<pre>add sp, sp, 0x1c</pre>
<pre>pop {r4, r5, r6, r7, r8, sb, pc}</pre>
<pre>mov r7, r3</pre>
<pre>mov r8, r2</pre>
<pre>mov r4, r0</pre>
<pre>ldr sb, [0x00006244]</pre>
<pre>add sb, pc, sb</pre>
<pre>str r5, [sp, 0x10]</pre>
<pre>str r3, [sp, 0xc]</pre>
<pre>stmib sp, {r1, r8}</pre>
<pre>str r6, [sp]</pre>
<pre>mov r3, 0x800</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, sb</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x800</pre>
<pre>bhs 0x6220</pre>
<pre>--</pre>
<pre>ldr r3, [0x00006ea8]</pre>
<pre>add r3, pc, r3</pre>
<pre>ldr r2, [0x00006eac]</pre>
<pre>ldr r3, [r3, r2]</pre>
<pre>str r3, [fp, -0x38]</pre>
<pre>ldr r3, [r3]</pre>
<pre>str r3, [fp, -0x28]</pre>
<pre>mov r5, 0</pre>
<pre>str r5, [fp, -0x30]</pre>
<pre>subs r3, r0, 0</pre>
<pre>str r3, [fp, -0x3c]</pre>
<pre>beq 0x6e7c</pre>
<pre>sub sp, sp, 0x28</pre>
<pre>add r4, sp, 8</pre>
<pre>mov r1, 1</pre>
<pre>str r1, [sp]</pre>
<pre>ldr r3, [0x00006eb0]</pre>
<pre>add r3, pc, r3</pre>
<pre>mov r2, 0x1b</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.__sprintf_chk</span></pre>
<pre>ldr r1, [0x00006eb4]</pre>
<pre>add r1, pc, r1</pre>
<pre>--</pre>
<pre>ldr r3, [r5]</pre>
<pre>str r3, [sp, 0x34]</pre>
<pre>mov r3, 0</pre>
<pre>str r3, [sp, 0xc]</pre>
<pre>tst r2, 0x1000</pre>
<pre>beq 0x7a68</pre>
<pre>cmp r1, r3</pre>
<pre>beq 0x7960</pre>
<pre>ldrb r3, [r1]</pre>
<pre>cmp r3, 0</pre>
<pre>bne 0x7a68</pre>
<pre>add r4, sp, 0x14</pre>
<pre>str r0, [sp, 4]</pre>
<pre>ldr r3, [0x00007b78]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x1e</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x1d</pre>
<pre>bhi 0x7b3c</pre>
<pre>--</pre>
<pre>mov r0, r4</pre>
<pre>ldr r2, [sp, 0x34]</pre>
<pre>ldr r3, [r5]</pre>
<pre>cmp r2, r3</pre>
<pre>bne 0x7b6c</pre>
<pre>add sp, sp, 0x3c</pre>
<pre>pop {r4, r5, r6, r7, r8, sb, pc}</pre>
<pre>mov r2, 0x280000</pre>
<pre>bl sym.imp.openat64</pre>
<pre>subs r6, r0, 0</pre>
<pre>blt 0x7ac8</pre>
<pre>add r4, sp, 0x14</pre>
<pre>str r6, [sp, 4]</pre>
<pre>ldr r3, [0x00007b84]</pre>
<pre>add r3, pc, r3</pre>
<pre>str r3, [sp]</pre>
<pre>mov r3, 0x1e</pre>
<pre>mov r2, 1</pre>
<pre>mov r1, r3</pre>
<pre>mov r0, r4</pre>
<pre><span class="red">bl sym.imp.__snprintf_chk</span></pre>
<pre>cmp r0, 0x1d</pre>
<pre>bls 0x7994</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> used </span><span class="orange">14</span> times </span><span class="orange">systemd-machine-id-setup</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
