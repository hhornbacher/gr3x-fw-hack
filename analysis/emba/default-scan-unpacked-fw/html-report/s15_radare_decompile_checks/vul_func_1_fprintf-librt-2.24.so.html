<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2023 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s): Pascal Eckmann
Contributor(s): Michael Messner, Stefan Haboeck
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s15_radare_decompile_checks.html" title="./../s15_radare_decompile_checks.html" >&laquo; Back to s15_radare_decompile_checks</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">librt-2.24.so</span></pre>
<br />
<pre>  </pre>
<pre>  	<span class="orange">Partial RELRO</span>  <span class="red">No Canary found</span>   <span class="green">NX enabled</span>   <span class="orange">DSO</span>          <span class="green">No RPATH</span>     <span class="green">No RUNPATH</span>   <span class="green">No Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">fprintf</span> tear down of </span><span class="orange">librt-2.24.so</span></pre>
<br />
<pre>    ; assembly                                   | /* r2dec pseudo code output */</pre>
<pre>                                                 | /* /logs/firmware/unblob_extracted/firmware_extract/20256560-34113329.romfs_extract/initramfs_extract/gzip.uncompressed_extract/lib/librt-2.24.so &commat; 0x454c4c40 */</pre>
<pre>                                                 | #include &lt;stdint.h&gt;</pre>
<pre>                                                 |  </pre>
<pre>                                                 | #define BIT_MASK(t,v) ((t)(-((v)!= 0)))&amp;(((t)-1)&gt;&gt;((sizeof(t)*CHAR_BIT)-(v)))</pre>
<pre>                                                 |  </pre>
<pre>    ; (fcn) fcn.454c4c40 ()                      | uint32_t fcn_454c4c40 (uint32_t arg1) {</pre>
<pre>                                                 |     int32_t var_4h_2;</pre>
<pre>                                                 |     r0 = arg1;</pre>
<pre>    0x454c4c40 tst r0, 2                         |     </pre>
<pre>                                                 |     if ((r0 &amp; 2) == 0) {</pre>
<pre>    0x454c4c44 bxne lr                           |         return r0;</pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4c48 push {r4, r5, r7, lr}             |     </pre>
<pre>    0x454c4c4c mrc p15, 0, lr, c13, c0, 3        |     __asm ("mrc p15, 0, lr, c13, c0, 3");</pre>
<pre>    0x454c4c50 sub sp, sp, 8                     |     </pre>
<pre>    0x454c4c54 sub ip, lr, 0x430                 |     </pre>
<pre>    0x454c4c58 ldr r3, [lr, -0x43c]              |     r3 = *((lr - 0x43c));</pre>
<pre>    0x454c4c5c sub ip, ip, 0xc                   |     </pre>
<pre>    0x454c4c60 add r0, sp, 4                     |     r0 += var_4h_2;</pre>
<pre>                                                 | label_0:</pre>
<pre>    0x454c4c64 bic r2, r3, 2                     |     r2 = BIT_MASK (r3, 2);</pre>
<pre>    0x454c4c68 str r3, [sp, 4]                   |     var_4h_2 = r3;</pre>
<pre>                                                 |     do {</pre>
<pre>    0x454c4c6c ldrex r1, [ip]                    |         __asm ("ldrex r1, [ip]");</pre>
<pre>    0x454c4c70 cmp r1, r3                        |         </pre>
<pre>                                                 |         if (r1 != r3) {</pre>
<pre>    0x454c4c74 bne 0x454c4c88                    |             goto label_3;</pre>
<pre>                                                 |         }</pre>
<pre>    0x454c4c78 strex r4, r2, [ip]                |         __asm ("strex r4, r2, [ip]");</pre>
<pre>    0x454c4c7c cmp r4, 0                         |         </pre>
<pre>    0x454c4c80 bne 0x454c4c6c                    |         </pre>
<pre>                                                 |     } while (r4 != 0);</pre>
<pre>    0x454c4c84 dmb ish                           |     __asm ("dmb ish");</pre>
<pre>                                                 |     if (r4 == 0) {</pre>
<pre>                                                 | label_3:</pre>
<pre>    0x454c4c88 strne r1, [r0]                    |         *(r0) = r1;</pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4c8c ldr r1, [sp, 4]                   |     r1 = var_4h_2;</pre>
<pre>    0x454c4c90 cmp r3, r1                        |     </pre>
<pre>                                                 |     if (r3 != r1) {</pre>
<pre>    0x454c4c94 bne 0x454c4cac                    |         goto label_4;</pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4c98 and r3, r3, 0xc                   |     r3 &amp;= 0xc;</pre>
<pre>    0x454c4c9c cmp r3, 4                         |     </pre>
<pre>    0x454c4ca0 beq 0x454c4cb4                    |     </pre>
<pre>                                                 |     while (r3 != 4) {</pre>
<pre>    0x454c4ca4 add sp, sp, 8                     |         </pre>
<pre>    0x454c4ca8 pop {r4, r5, r7, pc}              |         </pre>
<pre>                                                 | label_4:</pre>
<pre>    0x454c4cac mov r3, r1                        |         r3 = r1;</pre>
<pre>    0x454c4cb0 b 0x454c4c64                      |         goto label_0;</pre>
<pre>    0x454c4cb4 mov r5, 1                         |         r5 = 1;</pre>
<pre>    0x454c4cb8 movw r4, 0x881                    |         r4 = 0x881;</pre>
<pre>                                                 | label_1:</pre>
<pre>    0x454c4cbc mov r0, ip                        |         r0 = ip;</pre>
<pre>    0x454c4cc0 mov r1, 0x80                      |         r1 = 0x80;</pre>
<pre>    0x454c4cc4 mov r3, 0                         |         r3 = 0;</pre>
<pre>    0x454c4cc8 mov r7, 0xf0                      |         r7 = 0xf0;</pre>
<pre>    0x454c4ccc svc 0                             |         __asm ("svc 0");</pre>
<pre>    0x454c4cd0 cmn r0, 0x1000                    |         </pre>
<pre>                                                 |         if (r0 &gt; 0x1000) {</pre>
<pre>    0x454c4cd4 bhi 0x454c4cec                    |             goto label_5;</pre>
<pre>                                                 |         }</pre>
<pre>                                                 | label_2:</pre>
<pre>    0x454c4cd8 ldr r2, [lr, -0x43c]              |         r2 = *((lr - 0x43c));</pre>
<pre>    0x454c4cdc and r3, r2, 0xc                   |         r3 = r2 &amp; 0xc;</pre>
<pre>    0x454c4ce0 cmp r3, 4                         |         </pre>
<pre>    0x454c4ce4 bne 0x454c4ca4                    |         </pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4ce8 b 0x454c4cbc                      |     goto label_1;</pre>
<pre>                                                 | label_5:</pre>
<pre>    0x454c4cec add r0, r0, 0xb                   |     r0 += 0xb;</pre>
<pre>    0x454c4cf0 cmp r0, 0xb                       |     </pre>
<pre>                                                 |     if (r0 &gt; 0xb) {</pre>
<pre>    0x454c4cf4 bhi 0x454c4d00                    |         goto label_6;</pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4cf8 ands r3, r4, r5, lsl r0           |     r3 = r4 &amp; (r5 &lt;&lt; r0);</pre>
<pre>                                                 |     if (r3 != r4) {</pre>
<pre>    0x454c4cfc bne 0x454c4cd8                    |         goto label_2;</pre>
<pre>                                                 |     }</pre>
<pre>                                                 | label_6:</pre>
<pre>    0x454c4d00 ldr r0, [pc, 4]                   |     r0 = *(0x454c4d0c);</pre>
<pre>    0x454c4d04 add r0, pc, r0                    |     r0 = pc + r0;</pre>
<pre>    0x454c4d08 bl 0x454c14fc                     |     r0 = fcn_454c14fc ();</pre>
<pre>                                                 |     if (r3 != r4) {</pre>
<pre>    0x454c4d0c andeq r0, r0, r0, ror r2          |         r0 &amp;= (r0 &gt;&gt;&gt; r2);</pre>
<pre>                                                 |     }</pre>
<pre>    0x454c4d10 push {r4, r5, lr}                 |     </pre>
<pre>    0x454c4d14 sub sp, sp, 0x14                  |     </pre>
<pre>    0x454c4d18 ldr r5, [pc, 0x44]                |     r5 = *(0x454c4d60);</pre>
<pre>    0x454c4d1c ldr r4, [pc, 0x44]                |     r4 = *(0x454c4d64);</pre>
<pre>    0x454c4d20 add r5, pc, r5                    |     r5 = pc + r5;</pre>
<pre>    0x454c4d24 add r4, pc, r4                    |     r4 = pc + r4;</pre>
<pre>    0x454c4d28 ldr r3, [r5]                      |     r3 = *(0x454c4d60);</pre>
<pre>    0x454c4d2c cmp r3, 0                         |     </pre>
<pre>    0x454c4d30 beq 0x454c4d50                    |     </pre>
<pre>                                                 |     while (1) {</pre>
<pre>    0x454c4d34 ldr ip, [pc, 0x30]                |         ip = *(0x454c4d6c);</pre>
<pre>    0x454c4d38 ldr ip, [r4, ip]                  |         ip = *((r4 + ip));</pre>
<pre>    0x454c4d3c ldr ip, [ip]                      |         ip = *(ip);</pre>
<pre>    0x454c4d40 eor r3, r3, ip                    |         r3 ^= ip;</pre>
<pre>    0x454c4d44 add sp, sp, 0x14                  |         </pre>
<pre>    0x454c4d48 pop {r4, r5, lr}                  |         </pre>
<pre>    0x454c4d4c bx r3                             |         return uint32_t (*r3)() ();</pre>
<pre>    0x454c4d50 stmib sp, {r0, r1, r2}            |         __asm ("stmib sp, {r0, r1, r2}");</pre>
<pre>    0x454c4d54 bl 0x454c1740                     |         entry0 ();</pre>
<pre>    0x454c4d58 ldr r3, [r5]                      |         r3 = *(r5);</pre>
<pre>    0x454c4d5c ldmib sp, {r0, r1, r2}            |         __asm ("ldmib sp, {r0, r1, r2}");</pre>
<pre>    0x454c4d60 b 0x454c4d34                      |         </pre>
<pre>                                                 |     }</pre>
<pre>                                                 | }</pre>
<pre>    ; assembly                           | /* r2dec pseudo code output */</pre>
<pre>                                         | /* /logs/firmware/unblob_extracted/firmware_extract/20256560-34113329.romfs_extract/initramfs_extract/gzip.uncompressed_extract/lib/librt-2.24.so &commat; 0x454c4d90 */</pre>
<pre>                                         | #include &lt;stdint.h&gt;</pre>
<pre>                                         |  </pre>
<pre>    ; (fcn) fcn.454c4d90 ()              | void fcn_454c4d90 () {</pre>
<pre>    0x454c4d90 movw ip, 0x14bc           |     </pre>
<pre>    0x454c4d94 movt ip, 1                |     ip = 0x114bc;</pre>
<pre>    0x454c4d98 ldr ip, [pc, ip]          |     ip = *(0x454c4da0);</pre>
<pre>    0x454c4d9c cmp ip, 0                 |     </pre>
<pre>    0x454c4da0 beq 0x454c4dcc            |     </pre>
<pre>                                         |     while (1) {</pre>
<pre>    0x454c4da4 movw r2, 0x1294           |         </pre>
<pre>    0x454c4da8 movw r3, 0x3a4            |         </pre>
<pre>    0x454c4dac movt r2, 1                |         r2 = 0x11294;</pre>
<pre>    0x454c4db0 movt r3, 0                |         </pre>
<pre>    0x454c4db4 add r2, r2, pc            |         r2 += pc;</pre>
<pre>    0x454c4db8 ldr r3, [pc, r3]          |         r3 = *(0x454c4dc0);</pre>
<pre>    0x454c4dbc ldr r2, [r2, r3]          |         r2 = *((r2 + r3));</pre>
<pre>    0x454c4dc0 ldr r2, [r2]              |         r2 = *(r2);</pre>
<pre>    0x454c4dc4 eor ip, ip, r2            |         </pre>
<pre>    0x454c4dc8 bx ip                     |         return void (*ip)() ();</pre>
<pre>    0x454c4dcc push {r0, lr}             |         </pre>
<pre>    0x454c4dd0 bl 0x454c1740             |         entry0 ();</pre>
<pre>    0x454c4dd4 pop {r0, lr}              |         </pre>
<pre>    0x454c4dd8 movw ip, 0x1474           |         </pre>
<pre>    0x454c4ddc movt ip, 1                |         ip = 0x11474;</pre>
<pre>    0x454c4de0 ldr ip, [pc, ip]          |         ip = *(fcn.454c4de8);</pre>
<pre>    0x454c4de4 b 0x454c4da4              |         </pre>
<pre>                                         |     }</pre>
<pre>                                         | }</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">fprintf</span> used </span><span class="orange">1</span> times </span><span class="orange">librt-2.24.so</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
