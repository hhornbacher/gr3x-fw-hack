<!-- 
EMBA - EMBEDDED LINUX ANALYZER

Copyright 2020-2023 Siemens AG
Copyright 2020-2023 Siemens Energy AG

EMBA comes with ABSOLUTELY NO WARRANTY. This is free software, and you are
welcome to redistribute it under the terms of the GNU General Public License.
See LICENSE file for usage of this software.

EMBA is licensed under GPLv3

Author(s): Pascal Eckmann
Contributor(s): Michael Messner, Stefan Haboeck
-->

<!-- Used icons: https://github.com/CoreyGinnivan/system-uicons -->
 
<!DOCTYPE html>
<html lang="en">
<head>
  <title>EMBA firmware report</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./../style/style.css" type="text/css">
  <link rel="icon" type="image/png" href="./../style/favicon.png">
</head>
<body>

<div id="sidenav" class="side">
  <div id="logo">
    <a class="inherit" href="./../index.html"><img class="inherit" id="logoImage" src="./../style/emba.svg" alt="logo"></a>
  </div>
  <div id="nav">
      <a id="embark" class="hidden" href="{{ embarkBackUrl }}">&laquo; Back to EMBArk</a> <!-- nosem -->
      <a class="backButton" href="./../index.html">&laquo; Back to main</a>
<a class="modul" href="./../s15_radare_decompile_checks.html" title="./../s15_radare_decompile_checks.html" >&laquo; Back to s15_radare_decompile_checks</a>
      <!-- navigation start -->
      <!-- navigation end -->
      <input id="expand" class="expand_njs hidden" type="button" value="More results:" onclick="this.value=this.value=='+ Show more results'?'- Hide more results':'+ Show more results';">
      <div class="expand_area">
        <!-- etc start -->
        <!-- etc end -->
      </div>
  </div>
  <a href="TIMELINK"><div id="buttonTimeInvisible" class="rectButton"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round" transform="matrix(-1 0 0 1 19 2)"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 5.5v4H5"/></g></svg></div></a>
  <div id="buttonSizer" class="rectButton buttonClose" onclick="buttonNav()"></div>
</div>
<div id="main" class="main">
  <!-- content start -->
<pre>[</span><span class="orange">*</span>] Binary protection state of </span><span class="orange">collect</span></pre>
<br />
<pre>  </pre>
<pre>  	<span class="green">Full RELRO</span>     <span class="green">Canary found</span>      <span class="green">NX enabled</span>   <span class="green">PIE enabled</span>  <span class="green">No RPATH</span>     <span class="green">No RUNPATH</span>   <span class="green">No Symbols</pre>
<br />
<pre></span></pre>
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> tear down of </span><span class="orange">collect</span></pre>
<br />
<pre>    ; assembly                                   | /* r2dec pseudo code output */</pre>
<pre>                                                 | /* /logs/firmware/unblob_extracted/firmware_extract/20256560-34113329.romfs_extract/initramfs_extract/gzip.uncompressed_extract/lib/udev/collect &commat; 0x2c30 */</pre>
<pre>                                                 | #include &lt;stdint.h&gt;</pre>
<pre>                                                 |  </pre>
<pre>    ; (fcn) fcn.00002c30 ()                      | void fcn_00002c30 (int32_t arg2) {</pre>
<pre>                                                 |     int32_t var_0h_2;</pre>
<pre>                                                 |     int32_t var_4h;</pre>
<pre>                                                 |     int32_t var_8h;</pre>
<pre>                                                 |     int32_t var_10h;</pre>
<pre>                                                 |     int32_t var_14h;</pre>
<pre>                                                 |     int32_t var_0h;</pre>
<pre>                                                 |     int32_t var_24h;</pre>
<pre>                                                 |     int32_t var_28h;</pre>
<pre>                                                 |     r1 = arg2;</pre>
<pre>    0x00002c30 push {r7, lr}                     |     </pre>
<pre>    0x00002c34 sub sp, sp, 0x18                  |     </pre>
<pre>    0x00002c38 mov r6, r3                        |     r6 = r3;</pre>
<pre>    0x00002c3c ldr r3, [pc, 0x88]                |     </pre>
<pre>    0x00002c40 add r3, pc, r3                    |     r3 = pc + r3;</pre>
<pre>    0x00002c44 ldr r3, [r3]                      |     r3 = *(0x2cc8);</pre>
<pre>    0x00002c48 cmp r3, 1                         |     </pre>
<pre>    0x00002c4c bgt 0x2c54                        |     </pre>
<pre>                                                 |     while (1) {</pre>
<pre>    0x00002c50 bl 0xf78                          |         abort ();</pre>
<pre>    0x00002c54 mov r4, r1                        |         r4 = r1;</pre>
<pre>    0x00002c58 mov r5, r2                        |         r5 = r2;</pre>
<pre>    0x00002c5c ldr r7, [pc, 0x6c]                |         r7 = *(0x2ccc);</pre>
<pre>    0x00002c60 add r7, pc, r7                    |         r7 = pc + r7;</pre>
<pre>    0x00002c64 stmib sp, {r0, r4, r5, r6}        |         __asm ("stmib sp, {r0, r4, r5, r6}");</pre>
<pre>    0x00002c68 ldr r3, [pc, 0x64]                |         r3 = *(0x2cd0);</pre>
<pre>    0x00002c6c add r3, pc, r3                    |         r3 = pc + r3;</pre>
<pre>    0x00002c70 str r3, [sp]                      |         *(sp) = r3;</pre>
<pre>    0x00002c74 mov r3, 0x800                     |         r3 = 0x800;</pre>
<pre>    0x00002c78 mov r2, 1                         |         r2 = 1;</pre>
<pre>    0x00002c7c mov r1, r3                        |         r1 = r3;</pre>
<pre>    0x00002c80 mov r0, r7                        |         r0 = r7;</pre>
<pre><span class="red">    0x00002c84 bl 0x1098                         |         r0 = snprintf_chk ()</span></span></pre>
<pre>    0x00002c88 cmp r0, 0x800                     |         </pre>
<pre>                                                 |         if (r0 &gt;= 0x800) {</pre>
<pre>    0x00002c8c bhs 0x2cac                        |             goto label_0;</pre>
<pre>                                                 |         }</pre>
<pre>    0x00002c90 stm sp, {r6, r7}                  |         *(sp) = r6;</pre>
<pre>                                                 |         *((sp + 4)) = r7;</pre>
<pre>    0x00002c94 mov r3, r5                        |         r3 = r5;</pre>
<pre>    0x00002c98 mov r2, r4                        |         r2 = r4;</pre>
<pre>    0x00002c9c mov r1, 0                         |         r1 = 0;</pre>
<pre>    0x00002ca0 mov r0, 2                         |         r0 = 2;</pre>
<pre>    0x00002ca4 bl 0x2334                         |         fcn_00002334 (r0);</pre>
<pre>    0x00002ca8 b 0x2c50                          |         </pre>
<pre>                                                 |     }</pre>
<pre>                                                 | label_0:</pre>
<pre>    0x00002cac ldr r3, [pc, 0x24]                |     r3 = *(0x2cd4);</pre>
<pre>    0x00002cb0 add r3, pc, r3                    |     r3 = pc + r3;</pre>
<pre>    0x00002cb4 movw r2, 0x30a                    |     r2 = 0x30a;</pre>
<pre>    0x00002cb8 ldr r1, [pc, 0x1c]                |     r1 = *(0x2cd8);</pre>
<pre>    0x00002cbc add r1, pc, r1                    |     r1 = pc + r1;</pre>
<pre>    0x00002cc0 ldr r0, [pc, 0x18]                |     r0 = "_";</pre>
<pre>    0x00002cc4 add r0, pc, r0                    |     r0 = pc + r0;</pre>
<pre>    0x00002cc8 bl 0x2c30                         |     r0 = fcn_00002c30 (r0);</pre>
<pre>                                                 |     if (r0 != 0x800) {</pre>
<pre>    0x00002ccc andeq r2, r0, r0, asr 7           |         r2 = r0 &amp; (r0 &gt;&gt; 7);</pre>
<pre>                                                 |     }</pre>
<pre>                                                 |     if (r0 != 0x800) {</pre>
<pre>    0x00002cd0 andeq r2, r0, ip, lsr 7           |         r2 = r0 &amp; (ip &gt;&gt; 7);</pre>
<pre>                                                 |     }</pre>
<pre>                                                 |     if (r0 != 0x800) {</pre>
<pre>    0x00002cd4 andeq r0, r0, r4, asr 10          |         r0 &amp;= (r4 &gt;&gt; 10);</pre>
<pre>                                                 |     }</pre>
<pre>    0x00002cd8 strheq r0, [r0], -r4              |     __asm ("strheq r0, [r0], -r4");</pre>
<pre>                                                 |     if (r0 != 0x800) {</pre>
<pre>    0x00002cdc andeq r0, r0, r8, asr 4           |         r0 &amp;= (r8 &gt;&gt; 4);</pre>
<pre>                                                 |     }</pre>
<pre>                                                 |     /* Beware that this jump is a conditional jump.</pre>
<pre>                                                 |      * r2dec transformed it as a return, due being the</pre>
<pre>                                                 |      * last instruction. Please, check 'pdda' output</pre>
<pre>                                                 |      * for more hints. */</pre>
<pre>    0x00002ce0 andeq r0, r0, r8, lsr 10          |     return r0 &amp;= (r8 &gt;&gt; 10);</pre>
<pre>                                                 | }</pre>
<br />
<pre>[</span><span class="orange">*</span>] Function </span><span class="orange">printf</span> used </span><span class="orange">2</span> times </span><span class="orange">collect</span></pre>
<br />
  <!-- content end -->
</div>

<a href="https://github.com/e-m-b-a/emba" title="github.com/e-m-b-a/emba" target="_blank">
  <div id="buttonInfo" class="rectButtonVisible">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" transform="translate(2 2)"><g stroke="white" stroke-linecap="round" stroke-linejoin="round"><circle cx="8.5" cy="8.5" r="8"/><path d="M8.5 12.5v-4h-1"/><path d="M7.5 12.5h2"/></g><circle cx="8.5" cy="5.5" fill="white" r="1"/></g></svg>
  </div>
</a>
<div id="buttonBack" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M9.5 14.5l4-4l-4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
<div id="buttonForward" class="nonClickable rectButtonVisible"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><path d="M11.5 14.5l-4-4l4-4" fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"/></svg></div> 
<div id="buttonDown" class="rectButton" onclick="scrollDown()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 6.5l-4 4l-4-4"/><path d="M14.5 10.5l-4 4l-4-4"/></g></svg></div>
<div id="buttonUp" class="rectButton" onclick="scrollUp()"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 14.5l4-4l4 4"/><path d="M6.5 10.5l4-4l4 4"/></g></svg></div> 

<script>
window.onload = function () {
  var buttons = document.getElementsByClassName("rectButton");
  for (let i=0; i<buttons.length; i++) {
    buttons[i].style.visibility = "visible";
  }
  var buttonDown = document.getElementById("buttonDown");
  buttonDown.classList.add('rectButtonVisible');
  buttonDown.classList.remove('rectButton');

  var buttonUp = document.getElementById("buttonUp");
  buttonUp.classList.add('rectButtonVisible');
  buttonUp.classList.remove('rectButton');
    
  var buttonSizer = document.getElementById("buttonSizer");
  buttonSizer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
  if (document.getElementById("buttonTime") !== null) {
    var buttonTime = document.getElementById("buttonTime");
    buttonTime.style.bottom = "50px";
  }
  document.getElementById("expand").value = "+ Show more results";
  document.getElementById("expand").className += " expand";
  var embarkButton = document.getElementById("embark");
  if ( !(embarkButton.href.includes("embarkBackUrl")) ) {
    embarkButton.classList.remove('hidden');
    document.getElementById("logoImage").src = "./../style/embark.svg";
    document.getElementById("logo").style.background = "#2d2d2d";
  }
}

function openNav() {
  document.getElementById("sidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "250px";
  document.getElementById("nav").style.visibility = "visible";
}

function closeNav() {
  document.getElementById("sidenav").style.width = "50px";
  document.getElementById("sidenav").scrollTop = 0;
  document.getElementById("main").style.marginLeft = "50px";
  document.getElementById("nav").style.visibility = "hidden";
}

function scrollDown() {
  window.scrollTo(0,document.body.scrollHeight);
}

function scrollUp() {
  window.scrollTo(0,0);
}

function buttonNav() {
  var button = document.getElementById("buttonSizer");
  if ( button.classList.contains('buttonOpen') ) {
    button.classList.remove('buttonOpen');
    button.classList.add('buttonClose');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 16.5v-4.978l-5-.022"/><path d="M18.5 2.5l-7 7"/><path d="M16.5 9.5l-5 .023V4.5"/><path d="M9.5 11.5l-7 7"/></g></svg>';
    openNav();
  } else if( button.classList.contains('buttonClose') ) {
    button.classList.remove('buttonClose');
    button.classList.add('buttonOpen');
    button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="40" height="40" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 21 21"><g fill="none" fill-rule="evenodd" stroke="white" stroke-linecap="round" stroke-linejoin="round"><path d="M18.5 7.5v-5h-5"/><path d="M18.5 2.5l-6 5.929"/><path d="M7.5 18.5l-5 .023V13.5"/><path d="M8.5 12.5l-6 6"/></g></svg>';
    closeNav();
  };
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
      case 37:
        document.getElementById("buttonForward").parentNode.click(); 
        break;
      case 39:
        document.getElementById("buttonBack").parentNode.click();       
        break;
    }
};
</script>

</body>
</html>
